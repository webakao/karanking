<script>
  const hojas = [
    { nombre: "125", titulo: "Ranking General Consolidado" },
    { nombre: "SudChile", titulo: "Torneo Sudamericano Chile" },
    { nombre: "NacKyudo", titulo: "Torneo Nacional Kyudokan" },
    { nombre: "NakAKAO", titulo: "Torneo Nacional AKAO" },
    { nombre: "RankFakko1", titulo: "Torneo Raqueable FAKKO Nº1" },
    { nombre: "RankFakko2", titulo: "Torneo Raqueable FAKKO Nº2" },
    { nombre: "RankFakko3", titulo: "Torneo Raqueable FAKKO Nº3" },
    { nombre: "RankFakko4", titulo: "Torneo Raqueable FAKKO Nº4" },
  ];

  const sheetId = "1Uws6EozyrILb8clWBiWHUv7XQHyOWhTpmMMerqsFZJg";
  const contenedor = document.getElementById("contenedor-tablas");

  async function cargarCSVEnOrden() {
    for (const { nombre, titulo } of hojas) {
      const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(nombre)}`;
      try {
        const response = await fetch(url);
        const csvText = await response.text();
        const rows = csvText.trim().split('\n').map(row => row.split(','));

        const table = document.createElement('table');
        const caption = document.createElement('h3');
        caption.textContent = titulo;
        contenedor.appendChild(caption);

        const thead = document.createElement('thead');
        const tbody = document.createElement('tbody');

        rows.forEach((cols, index) => {
          const tr = document.createElement('tr');
          cols.forEach(col => {
            const cell = document.createElement(index === 0 ? 'th' : 'td');
            cell.textContent = col.trim();
            tr.appendChild(cell);
          });
          (index === 0 ? thead : tbody).appendChild(tr);
        });

        table.appendChild(thead);
        table.appendChild(tbody);
        contenedor.appendChild(table);
      } catch (error) {
        console.error(`Error al cargar ${nombre}:`, error);
      }
    }
  }

  cargarCSVEnOrden();
</script>

